<style>
.label:target, .row-number:target {
  border: black 2pt dotted;
}

table {
  border-collapse: collapse;
  margin: 1em;
}
table.assumption-table {
}
table.data-table {
}
table.threat-table {
}
table.measure-table {
}
table.interaction-table {
}

th, td {
  border: 1px solid black;
  padding: 2px 12px;
}
th {
  background-color: LightGrey;
}
td > a {
  color: inherit;
  text-decoration: none;
}
td > a:hover {
  text-decoration: underline;
}

#diagram {
}

div.label {
  background-color: WhiteSmoke;
  border-radius: 4px;
  margin: 4px 0px;
  padding: 4px;
}
div.assumption-label {
}
div.data-label {
}
div.threat-label {
}
div.mitigation-label {
  margin-left: 12px;
  padding-left: 6px;
}

div.description {
}
div.assumption-description {
}
div.data-description {
}
div.threat-description {
}

div.row-number {
}
div.assumption-number {
}
div.data-number {
}
div.threat-number {
}
div.interaction-number {
}
div.interaction-notes {
}

div.classification-public {
}
div.classification-restricted {
  font-style: italic;
}
div.classification-confidential {
  font-weight: bold;
}

div.risk-low {
  background-color: Khaki;
}
div.risk-medium {
  background-color: SandyBrown;
}
div.risk-high {
  background-color: Tomato;
}

div.imperative-none {
}
div.imperative-may {
}
div.imperative-should {
  font-style: italic;
}
div.imperative-must {
  font-weight: bold;
}

div.capability-detective {
  background-color: LightSkyBlue;
}
div.capability-partial {
  background: #c2e184;
}
div.capability-full {
  background: LimeGreen;
}

div.status-pending {
  background-image: linear-gradient(to right, rgba(0,0,0,0), rgba(255,255,255,0.9) 25%);
}
div.status-implemented {
  background-image: linear-gradient(to right, rgba(0,0,0,0), rgba(255,255,255,0.9) 75%);
}
div.status-verified {
}

div.dash {
  text-align: center;
}
</style>

<table class="assumption-table">
<thead>
<th>#</th>
<th>Disprove</th>
<th>Description</th>
</thead>
<tbody>
<tr>
<td>
<div class="row-number assumption-number">1</div>
</td>
<td>
<div id="lack-of-tls" class="label assumption-label risk-high">Lack of TLS</div>
</td>
<td>
<div class="dash">-</div>
</td>
</tr>
<tr>
<td>
<div class="row-number assumption-number">2</div>
</td>
<td>
<div id="improper-error-handling" class="label assumption-label risk-medium">Improper Error Handling</div>
</td>
<td>
<div class="dash">-</div>
</td>
</tr>
</tbody>
</table>

<table class="data-table">
<thead>
<th>#</th>
<th>Data</th>
<th>Description</th>
</thead>
<tbody>
<tr>
<td>
<div class="row-number data-number">1</div>
</td>
<td>
<div id="pw" class="label data-label classification-confidential">pw</div>
</td>
<td>
<div class="dash">-</div>
</td>
</tr>
<tr>
<td>
<div class="row-number data-number">2</div>
</td>
<td>
<div id="session-cookie" class="label data-label classification-restricted">session cookie</div>
</td>
<td>
<div class="dash">-</div>
</td>
</tr>
<tr>
<td>
<div class="row-number data-number">3</div>
</td>
<td>
<div id="un" class="label data-label classification-public">un</div>
</td>
<td>
<div class="dash">-</div>
</td>
</tr>
</tbody>
</table>

<table class="threat-table">
<thead>
<th>#</th>
<th>Active Threat</th>
<th>Applicable Measures</th>
<th>Description</th>
</thead>
<tbody>
<tr>
<td>
<div class="row-number threat-number">1</div>
</td>
<td>
<div id="command-injection" class="label threat-label risk-high">Command Injection</div>
</td>
<td>
<a href="#input-validation"><div class="label measure-label capability-full">Input Validation</div></a>
<a href="#blocking-waf"><div class="label measure-label capability-partial">Blocking WAF</div></a>
<a href="#learning-waf"><div class="label measure-label capability-detective">Learning WAF</div></a>
</td>
<td>
<div class="dash">-</div>
</td>
</tr>
<tr>
<td>
<div class="row-number threat-number">2</div>
</td>
<td>
<div id="cross-site-scripting" class="label threat-label risk-high">Cross-Site Scripting</div>
</td>
<td>
<a href="#input-validation"><div class="label measure-label capability-full">Input Validation</div></a>
<a href="#blocking-waf"><div class="label measure-label capability-partial">Blocking WAF</div></a>
<a href="#learning-waf"><div class="label measure-label capability-detective">Learning WAF</div></a>
</td>
<td>
<div class="dash">-</div>
</td>
</tr>
<tr>
<td>
<div class="row-number threat-number">3</div>
</td>
<td>
<div id="database-injection" class="label threat-label risk-high">Database Injection</div>
</td>
<td>
<a href="#input-validation"><div class="label measure-label capability-full">Input Validation</div></a>
<a href="#parameterized-queries"><div class="label measure-label capability-full">Parameterized Queries</div></a>
<a href="#blocking-waf"><div class="label measure-label capability-partial">Blocking WAF</div></a>
<a href="#learning-waf"><div class="label measure-label capability-detective">Learning WAF</div></a>
</td>
<td>
<div class="dash">-</div>
</td>
</tr>
<tr>
<td>
<div class="row-number threat-number">4</div>
</td>
<td>
<div id="information-disclosure" class="label threat-label risk-medium">Information Disclosure</div>
</td>
<td>
</td>
<td>
<div class="dash">-</div>
</td>
</tr>
</tbody>
</table>

<table class="measure-table">
<thead>
<th>#</th>
<th>Security Measure</th>
<th>Mitigable Threats</th>
<th>Description</th>
</thead>
<tbody>
<tr>
<td>
<div class="row-number measure-number">1</div>
</td>
<td>
<div id="input-validation" class="label measure-label capability-full">Input Validation</div>
</td>
<td>
<a href="#command-injection"><div class="label threat-label risk-high">Command Injection</div></a>
<a href="#cross-site-scripting"><div class="label threat-label risk-high">Cross-Site Scripting</div></a>
<a href="#database-injection"><div class="label threat-label risk-high">Database Injection</div></a>
</td>
<td>
<div class="description measure-description"><a href="https://cheatsheetseries.owasp.org/cheatsheets/Input_Validation_Cheat_Sheet.html">Click for more info</a></div>
</td>
</tr>
<tr>
<td>
<div class="row-number measure-number">2</div>
</td>
<td>
<div id="parameterized-queries" class="label measure-label capability-full">Parameterized Queries</div>
</td>
<td>
<a href="#database-injection"><div class="label threat-label risk-high">Database Injection</div></a>
</td>
<td>
<div class="dash">-</div>
</td>
</tr>
<tr>
<td>
<div class="row-number measure-number">3</div>
</td>
<td>
<div id="blocking-waf" class="label measure-label capability-partial">Blocking WAF</div>
</td>
<td>
<a href="#command-injection"><div class="label threat-label risk-high">Command Injection</div></a>
<a href="#cross-site-scripting"><div class="label threat-label risk-high">Cross-Site Scripting</div></a>
<a href="#database-injection"><div class="label threat-label risk-high">Database Injection</div></a>
</td>
<td>
<div class="description measure-description">WAF in blocking mode</div>
</td>
</tr>
<tr>
<td>
<div class="row-number measure-number">4</div>
</td>
<td>
<div id="learning-waf" class="label measure-label capability-detective">Learning WAF</div>
</td>
<td>
<a href="#command-injection"><div class="label threat-label risk-high">Command Injection</div></a>
<a href="#cross-site-scripting"><div class="label threat-label risk-high">Cross-Site Scripting</div></a>
<a href="#database-injection"><div class="label threat-label risk-high">Database Injection</div></a>
</td>
<td>
<div class="description measure-description">WAF in learning mode</div>
</td>
</tr>
</tbody>
</table>

<div id="diagram">
<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: %3 Pages: 1 -->
<svg width="172pt" height="131pt"
 viewBox="0.00 0.00 172.00 131.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 127)">
<title>%3</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-127 168,-127 168,4 -4,4"/>
<!-- 1 -->
<!-- 2 -->
<!-- 1&#45;&gt;2 -->
<!-- Web App -->
<g id="node3" class="node">
<title>Web App</title>
<g id="a_node3"><a xlink:title="Web App">
<ellipse fill="white" stroke="black" cx="101" cy="-105" rx="51.99" ry="18"/>
<text text-anchor="middle" x="101" y="-101.3" font-family="Times,serif" font-size="14.00">Web App</text>
</a>
</g>
</g>
<!-- DB -->
<g id="node4" class="node">
<title>DB</title>
<g id="a_node4"><a xlink:title="DB">
<polygon fill="white" stroke="black" points="82,-36 32,-36 28,-32 28,0 78,0 82,-4 82,-36"/>
<polyline fill="none" stroke="black" points="78,-32 28,-32 "/>
<polyline fill="none" stroke="black" points="78,-32 78,0 "/>
<polyline fill="none" stroke="black" points="78,-32 82,-36 "/>
<text text-anchor="middle" x="55" y="-14.3" font-family="Times,serif" font-size="14.00">DB</text>
</a>
</g>
</g>
<!-- Web App&#45;&gt;DB -->
<g id="edge3" class="edge">
<title>Web App&#45;&gt;DB</title>
<g id="a_edge3"><a xlink:href="#interaction-2" xlink:title="pw&#10;un">
<path fill="none" stroke="black" d="M82,-88.07C76.44,-82.55 70.84,-75.98 67,-69 63.15,-62.01 60.53,-53.81 58.74,-46.09"/>
<polygon fill="black" stroke="black" points="62.13,-45.18 56.79,-36.03 55.26,-46.51 62.13,-45.18"/>
</a>
</g>
<g id="a_edge3&#45;label"><a xlink:href="#interaction-2" xlink:title="pw&#10;un">
<text text-anchor="middle" x="78.5" y="-57.8" font-family="Times,serif" font-size="14.00"> &#160;2 </text>
<polyline fill="none" stroke="black" points="90,-54 67,-54 66.29,-67.68 "/>
</a>
</g>
</g>
<!-- User -->
<g id="node5" class="node">
<title>User</title>
<g id="a_node5"><a xlink:title="User">
<polygon fill="black" stroke="black" points="164,-36 110,-36 110,0 164,0 164,-36"/>
<text text-anchor="middle" x="137" y="-14.3" font-family="Times,serif" font-size="14.00" fill="white">User</text>
</a>
</g>
</g>
<!-- Web App&#45;&gt;User -->
<g id="edge4" class="edge">
<title>Web App&#45;&gt;User</title>
<g id="a_edge4"><a xlink:href="#interaction-3" xlink:title="session cookie">
<path fill="none" stroke="black" d="M96.1,-86.62C94.21,-76.67 93.46,-64.17 98,-54 99.66,-50.27 101.94,-46.78 104.56,-43.55"/>
<polygon fill="black" stroke="black" points="107.3,-45.75 111.65,-36.09 102.23,-40.93 107.3,-45.75"/>
</a>
</g>
<g id="a_edge4&#45;label"><a xlink:href="#interaction-3" xlink:title="session cookie">
<text text-anchor="middle" x="109.5" y="-57.8" font-family="Times,serif" font-size="14.00"> &#160;3 </text>
<polyline fill="none" stroke="black" points="121,-54 98,-54 98.04,-53.91 "/>
</a>
</g>
</g>
<!-- User&#45;&gt;Web App -->
<g id="edge2" class="edge">
<title>User&#45;&gt;Web App</title>
<g id="a_edge2"><a xlink:href="#interaction-1" xlink:title="pw&#10;un">
<path fill="none" stroke="black" d="M134.48,-36.17C132.64,-46.06 129.64,-58.56 125,-69 123.55,-72.26 121.79,-75.55 119.88,-78.72"/>
<polygon fill="black" stroke="black" points="116.82,-77.01 114.29,-87.29 122.69,-80.83 116.82,-77.01"/>
</a>
</g>
<g id="a_edge2&#45;label"><a xlink:href="#interaction-1" xlink:title="pw&#10;un">
<text text-anchor="middle" x="141.5" y="-57.8" font-family="Times,serif" font-size="14.00"> &#160;1 </text>
<polyline fill="none" stroke="black" points="153,-54 130,-54 129.22,-57.69 "/>
</a>
</g>
</g>
</g>
</svg>
</div>

<table class="interaction-table">
<thead>
<th>#</th>
<th>Data</th>
<th>Data Threats</th>
<th>Interaction Threats</th>
<th>Notes</th>
</thead>
<tbody>
<tr>
<td rowspan="2"><a href=#diagram><div id="interaction-1" class="row-number interaction-number">1</div></a></td>
<td><a href="#pw"><div class="label data-label classification-confidential">pw</div></a></td>
<td rowspan=1>
<a href="#command-injection"><div class="label threat-label risk-high">Command Injection</div></a>
<a href="#input-validation"><div class="label mitigation-label imperative-must capability-full status-pending">Input Validation</div></a>
<a href="#learning-waf"><div class="label mitigation-label imperative-may capability-detective status-pending">Learning WAF</div></a>
</td>
<td rowspan="2"><div class="dash">-</div></td>
<td rowspan="2">
<div class="dash">-</div>
</td>
</tr>
<tr>
<td><a href="#un"><div class="label data-label classification-public">un</div></a></td>
<td rowspan=1>
<a href="#cross-site-scripting"><div class="label threat-label risk-high">Cross-Site Scripting</div></a>
<a href="#input-validation"><div class="label mitigation-label imperative-must capability-full status-pending">Input Validation</div></a>
<a href="#blocking-waf"><div class="label mitigation-label imperative-should capability-partial status-implemented">Blocking WAF</div></a>
</td>
</tr>
<tr>
<td rowspan="2"><a href=#diagram><div id="interaction-2" class="row-number interaction-number">2</div></a></td>
<td><a href="#pw"><div class="label data-label classification-confidential">pw</div></a></td>
<td><div class="dash">-</div></td>
<td rowspan=2>
<a href="#database-injection"><div class="label threat-label risk-high">Database Injection</div></a>
<a href="#parameterized-queries"><div class="label mitigation-label imperative-must capability-full status-pending">Parameterized Queries</div></a>
</td>
<td rowspan="2">
<div class="dash">-</div>
</td>
</tr>
<tr>
<td><a href="#un"><div class="label data-label classification-public">un</div></a></td>
<td><div class="dash">-</div></td>
</tr>
<tr>
<td rowspan="1"><a href=#diagram><div id="interaction-3" class="row-number interaction-number">3</div></a></td>
<td><a href="#session-cookie"><div class="label data-label classification-restricted">session cookie</div></a></td>
<td><div class="dash">-</div></td>
<td rowspan=1>
<a href="#information-disclosure"><div class="label threat-label risk-medium">Information Disclosure</div></a>
</td>
<td rowspan="1">
<div class="dash">-</div>
</td>
</tr>
</tbody>
</table>